<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>列表页</title>
    <link rel="stylesheet" href="../css/base_px.css">
    <link rel="stylesheet" href="../css/头部.css">
    <link rel="stylesheet" href="../sass/03.css">
    <link rel="stylesheet" href="../font_1608291_c2v6spe16cd/iconfont.css">
    <script src="../js/jquery-3.4.1.js"></script>
</head>

<body>
    <header></header>
    <div id="fullSlide" style="background: #fff;height:678px">
        <div class="fullSlide">
            <div style="width:100%;height:678px"><img src="../img/详情页.png" alt="" style="width:100%;height:678px"></div>
        </div>
    </div>
    <div class="main">
        <div class="aside-m">
            <div class="mc">
                <h2>一周热销排行</h2>
                <ul class="clearfix">
                    <li>
                        <div class="topSale-container topSaleOne">
                            <a href="//item.ingping.com/8937.html" base="//item.ingping.com" params="[id:8937]"
                                target="_blank" title="富克斯特(Focusrite) Scarlett Solo 三代 专业录音声卡 USB外置声卡音频接口 升级版"
                                class="topSaleImg fl">
                                <img alt="富克斯特(Focusrite) Scarlett Solo 三代 专业录音声卡 USB外置声卡音频接口 升级版"
                                    src="https://img.ingping.com/images/product/M/201912/201912311649124293572.jpg">
                            </a>
                            <div class="topSaleMessage fl">
                                <a href="//item.ingping.com/8937.html" base="//item.ingping.com" params="[id:8937]"
                                    target="_blank" title="富克斯特(Focusrite) Scarlett Solo 三代 专业录音声卡 USB外置声卡音频接口 升级版">
                                    富克斯特(Focusrite) Scarlett Solo 三代 专业录音声卡 USB外置声卡音频接口 升级版
                                </a>
                                <strong class="topSalePrice">¥828.00</strong>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="topSale-container topSaleTwo">
                            <a href="//item.ingping.com/9101.html" base="//item.ingping.com" params="[id:9101]"
                                target="_blank" title="RME Babyface Pro FS  专业录音USB外置声卡 高品质主播直播K歌声卡 （Babyface Pro升级版）"
                                class="topSaleImg fl">
                                <img alt="RME Babyface Pro FS  专业录音USB外置声卡 高品质主播直播K歌声卡 （Babyface Pro升级版）"
                                    src="https://img.ingping.com/images/product/M/201912/201912311658234998031.jpg"
                                    onerror="this.onerror=null;pagespeed.lazyLoadImages.loadIfVisibleAndMaybeBeacon(this);">
                            </a>
                            <div class="topSaleMessage fl">
                                <a href="//item.ingping.com/9101.html" base="//item.ingping.com" params="[id:9101]"
                                    target="_blank"
                                    title="RME Babyface Pro FS  专业录音USB外置声卡 高品质主播直播K歌声卡 （Babyface Pro升级版）">
                                    RME Babyface Pro FS 专业录音USB外置声卡 高品质主播直播K歌声卡 （Babyface Pro升级版）
                                </a>
                                <strong class="topSalePrice">¥5329.00</strong>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="topSale-container topSaleThree">
                            <a href="//item.ingping.com/5290.html" base="//item.ingping.com" params="[id:5290]"
                                target="_blank" title="雅马哈(YAMAHA) AG03 调音台外置声卡 电脑手机录音网络K歌主播直播声卡" class="topSaleImg fl">
                                <img alt="雅马哈(YAMAHA) AG03 调音台外置声卡 电脑手机录音网络K歌主播直播声卡"
                                    src="https://img.ingping.com/images/product/M/201912/201912311726441172764.jpg"
                                    onerror="this.onerror=null;pagespeed.lazyLoadImages.loadIfVisibleAndMaybeBeacon(this);">
                            </a>
                            <div class="topSaleMessage fl">
                                <a href="//item.ingping.com/5290.html" base="//item.ingping.com" params="[id:5290]"
                                    target="_blank" title="雅马哈(YAMAHA) AG03 调音台外置声卡 电脑手机录音网络K歌主播直播声卡">
                                    雅马哈(YAMAHA) AG03 调音台外置声卡 电脑手机录音网络K歌主播直播声卡
                                </a>
                                <strong class="topSalePrice">¥1168.00</strong>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="topSale-container ">
                            <a href="//item.ingping.com/8807.html" base="//item.ingping.com" params="[id:8807]"
                                target="_blank" title="普瑞声纳(Presonus) studio 24C 2进2出USB-C音频接口 专业录音编曲K歌声卡"
                                class="topSaleImg fl">
                                <img alt="普瑞声纳(Presonus) studio 24C 2进2出USB-C音频接口 专业录音编曲K歌声卡"
                                    src="https://img.ingping.com/images/product/M/20195/20190516144824199313.jpg"
                                    onerror="this.onerror=null;pagespeed.lazyLoadImages.loadIfVisibleAndMaybeBeacon(this);">
                            </a>
                            <div class="topSaleMessage fl">
                                <a href="//item.ingping.com/8807.html" base="//item.ingping.com" params="[id:8807]"
                                    target="_blank" title="普瑞声纳(Presonus) studio 24C 2进2出USB-C音频接口 专业录音编曲K歌声卡">
                                    普瑞声纳(Presonus) studio 24C 2进2出USB-C音频接口 专业录音编曲K歌声卡
                                </a>
                                <strong class="topSalePrice">¥999.00</strong>
                            </div>
                        </div>
                    </li>
                    <li>
                        <div class="topSale-container ">
                            <a href="//item.ingping.com/8943.html" base="//item.ingping.com" params="[id:8943]"
                                target="_blank" title="富克斯特(Focusrite) Scarlett Solo Studio 三代 专业录音编曲麦克风声卡套装"
                                class="topSaleImg fl">
                                <img alt="富克斯特(Focusrite) Scarlett Solo Studio 三代 专业录音编曲麦克风声卡套装"
                                    src="https://img.ingping.com/images/product/M/201912/201912311650542325906.jpg"
                                    onerror="this.onerror=null;pagespeed.lazyLoadImages.loadIfVisibleAndMaybeBeacon(this);">
                            </a>
                            <div class="topSaleMessage fl">
                                <a href="//item.ingping.com/8943.html" base="//item.ingping.com" params="[id:8943]"
                                    target="_blank" title="富克斯特(Focusrite) Scarlett Solo Studio 三代 专业录音编曲麦克风声卡套装">
                                    富克斯特(Focusrite) Scarlett Solo Studio 三代 专业录音编曲麦克风声卡套装
                                </a>
                                <strong class="topSalePrice">¥1659.00</strong>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
            <div class="border"></div>
            <div class="mb">
                <h2>达人都在看</h2>
                <div class="mb-span">
                    <span class="item"></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div class="mt">
                <h2>精选活动专场</h2>
                <ul>
                    <li>手机直播专场&nbsp;<span>></span></li>
                    <li>演出印象专场&nbsp;<span>></span></li>
                    <li>家庭KTV专场&nbsp;<span>></span></li>
                    <li>吉他乐器专场&nbsp;<span>></span></li>
                    <li>影视录音专场&nbsp;<span>></span></li>
                    <li>音乐欣赏专场&nbsp;<span>></span></li>
                    <li>家庭影院专场&nbsp;<span>></span></li>
                    <li>会议工程专场&nbsp;<span>></span></li>

                </ul>
            </div>
            <div class="mm">
                <img src="https://ubmcmm.baidustatic.com/media/v1/0f0000-_pbm7Nz3r_VTKs6.jpg" alt=""
                    style='width:230px;'>
            </div>
        </div>
        <div class="main-list">
            <div class="main-top">
                <div class="main-sort">
                    <a href="javascript:void(0)"><span>综合</span></a>
                    <a href="javascript:void(0)"><span>销量</span></a>
                    <a href="javascript:void(0)"><span>价格</span></a>
                    <a href="javascript:void(0)"><span>新品</span></a>
                </div>
                <div class="main-page">
                    <span><a href=""></a>&lt</span>
                    <span><a href=""></a>&gt</span>
                </div>
            </div>
            <div class="main-dowm">

            </div>
            <div class="foot"></div>
        </div>
    </div>
    <!-- 右侧导航栏 -->
    <div class="right_nav">
        <a href="./buyCar.html">
            <div>
                <span class="iconfont icon-gouwuchekong"></span>
                <p>购物车</p>
                <span
                    style="border:1px solid #ccc;border-radius: 50%;display:inline-block;width:20px;height:20px;line-height: 20px;">3</span>
            </div>
        </a>
    </div>
    <script>
        window.onload = function () {
            new Promise(function (resolve, reject) {
                $("header").load("./首页.html #top");
                resolve();
            }).then(function () {
                // return new Promise(function (resolve, reject) {
                //     $.getScript("../js/首页头部效果.js");

                //     resolve();
                // })
                $.getScript("../js/aaa.js");
                // }).then(function () {
                //     $.getScript("../js/aaa.js");
                // })
            })


            //达人也在看--轮播图
            $.getJSON("../server/details-left-lunbo.json", function (res) {
                res.forEach((element, index) => {
                    let oDiv = $(`<div class='mb-list ${index==0?'item':''}'></div>`);
                    let html = element.map(ele => {
                        return `<li>
                            <img src=${ele.src} alt="">
                            <div class="mb-title">${ele.price}</div>
                            <div class="mb-price">${ele.title}</div>
                        </li>`
                    }).join("");
                    oDiv.html(html);
                    if (index == 3) return;
                    $(".mb").append(oDiv);
                });
                let count = 0;
                var timer;
                time();

                function time() {
                    timer = setInterval(() => {
                        count++;
                        if (count > 2) {
                            count = 0;
                        }
                        $(".mb-list").eq(count).addClass("item").siblings().removeClass("item");
                        $(".mb-span span").eq(count).addClass("item").siblings().removeClass(
                            "item");
                    }, 2000)
                }
                $(".mb").mouseenter(() => clearInterval(timer));
                $(".mb").mouseleave(() => time());
            })
            //还是列表页
            render(1, 0);

            function render(page, orderType) {
                $.ajax({
                    type: "get",
                    url: "../../server/getDatalist.php",
                    data: `page=${page}&orderType=${orderType}`,
                    dataType: "json",
                    success: function (res) {
                        let html = res.data.map((ele, index) => {
                            let result = ele["minImg"].split("&").map(ele123 => {
                                return `<li><img src=${ele123} alt=""></li>`
                            }).join("");
                            return `<li data-index=${index}>
                                        <img src=${ele.src} alt="">
                                        <div class="minImg">
                                            <div class="itemLeft">&lt</div>
                                            <div class="itemzhong">
                                                <ul>${result}</ul>
                                            </div>
                                            <div class="itemRight">&gt</div>
                                            </div>
                                            <div class="price">￥${ele.price}<del>￥${ele.ele}</del></div>
                                            <div class="name">${ele.name}</div>
                                            <div class="commit">
                                            <span class="iconfont icon-xinxi"></span>
                                             ${ele.commit}
                                             <span class="joinBuyCar">加入购物车</span></div>
                                        </li>`
                        }).join("");
                        $(".main-dowm").html(html);
                        $(".minImg .itemzhong li").mouseenter(function () {
                            src = $(this).find("img")[0].src.replace("/S/", "/MLI/");
                            $(this).parents("li").children("img")[0].src = src;
                        })
                        let num1 = 0;
                        $(".itemLeft").click(function () {
                            let index = $(this).next().find("ul").children().length;
                            ++num1;
                            if ((index - num1) >= 5) {
                                left = $(this).next().find("ul")[0].offsetLeft - 40 + "px"
                                $(this).next().find("ul").stop().animate({
                                    left
                                })
                            }

                        })
                        $(".itemRight").click(function () {
                            if ($(this).prev().find("ul")[0].offsetLeft < 0) {
                                left = $(this).prev().find("ul")[0].offsetLeft + 40;
                                $(this).prev().find("ul").stop().animate({
                                    left: left + "px",
                                })
                            }
                        })
                        //去详情页
                        $(".main-dowm>li").click(function () {
                            let index = $(this).data("index");
                            console.log(index);

                            window.location.href =
                                `http://127.0.0.1/YingPingMall/code/html/%e8%af%a6%e6%83%85%e9%a1%b5.html?id=${index}`;
                        })
                    }
                });
            }

            // 获取数据并建立有几页， 分页功能
            $.ajax({
                type: "get",
                url: "../../server/getDataCount.php",
                dataType: "json",
                success: function (response) {
                    for (let i = 0; i < response.data.count; i++) {
                        $(".foot").append(`<span class=${i==0?"item":""}>${i+1}</span>`)
                    }
                }
            })
            // 分页功能
            let page, sort;
            $(".foot").on("click", "span", function () {
                page = $(this).index();
                $(this).addClass("item").siblings().removeClass("item");
                render(page, 0);
            })
            //排序功能
            $(".main-sort").on("click", "a", function () {
                sort = $(this).index();
                $(this).addClass("item").siblings().removeClass("item");
                render(page, sort);
            })

            //去详情页
            console.log($(".main-dowm li"));

            $(".main-dowm li").click(function () {
                console.log("---");

                window.location.href =
                    "http://127.0.0.1/YingPingMall/code/html/%e8%af%a6%e6%83%85%e9%a1%b5.html?";
            })

        }
    </script>
</body>

</html>